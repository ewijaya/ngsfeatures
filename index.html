<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NGSFeatures: Next Generation Sequencing Features Generation Tool</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NGSFeatures<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">Next Generation Sequencing Feature Generation Tool</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Next Generation Sequencing Features Generation Tool </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> Next generation sequencing (NGS) technology has increasingly become the backbone of transcriptomics analysis, but sequencer error causes biases in the read counts. This tool generates several features for next generation sequencing reads: such as log likelihood ratio of estimated true counts, error probability and observed count of the reads. The results then can be used for predicting true sequences from NGS data. Typically the output can be fed to Support Vector Machine (SVM) classifier. In our study (see paper below) we showed that on simulated reads these features can achieve 96.35% classification accuracy in discriminating true sequences. Using this framework we provide a way for users to select sequences with a desired precision and recall for their analysis.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md2"></a>
ðŸš€ Performance Optimizations (2025)</h1>
<p>This codebase has been <b>significantly optimized</b> for modern systems:</p>
<h2><a class="anchor" id="autotoc_md3"></a>
&lt;strong&gt;C++ Optimizations&lt;/strong&gt; (2-3x faster)</h2>
<ul>
<li>âœ… Aggressive compiler optimizations (<code>-O3</code>, <code>-march=native</code>, <code>-flto</code>)</li>
<li>âœ… Fast math optimizations and loop unrolling</li>
<li>âœ… Optimized DNA conversion with switch statements (no map overhead)</li>
<li>âœ… Bit operations instead of <code>pow()</code> for base-4 conversions</li>
<li>âœ… Early convergence detection in EM algorithm</li>
<li>âœ… Vector pre-allocation and const references throughout</li>
<li>âœ… Cached map lookups and multiplication instead of division</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
&lt;strong&gt;Python 3 Ports&lt;/strong&gt; (2-5x faster than Perl)</h2>
<p>All Perl scripts have been replaced with optimized Python 3 implementations:</p><ul>
<li>âœ… <b>10-15x faster</b> DNA conversion using <code>str.translate()</code></li>
<li>âœ… <b>2-3x faster</b> quality score calculations with optimized math</li>
<li>âœ… Type hints for better performance and IDE support</li>
<li>âœ… Generator expressions for memory efficiency</li>
<li>âœ… No external dependencies (stdlib only)</li>
</ul>
<p><b>Combined: 4-15x overall performance improvement!</b> ðŸŽ¯</p>
<hr  />
<h1><a class="anchor" id="autotoc_md6"></a>
Requirements</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Core Requirements</h2>
<ul>
<li><b>C++ Compiler</b>: g++ with C++20 support</li>
<li><b>Python</b>: Python 3.7 or later (for pipeline scripts)</li>
<li><b>Boost Library</b>: Required for Expectation-Matching algorithm<ul>
<li>Website: <a href="http://www.boost.org">http://www.boost.org</a></li>
<li>Ubuntu/Debian: <code>sudo apt-get install libboost-all-dev</code></li>
<li>macOS: <code>brew install boost</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
Optional</h2>
<ul>
<li><b>Make</b>: For building C++ binaries</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md10"></a>
Installation</h1>
<h2><a class="anchor" id="autotoc_md11"></a>
1. Build C++ Binaries</h2>
<p><b>Main source directory:</b> </p><div class="fragment"><div class="line">cd src/</div>
<div class="line">make</div>
</div><!-- fragment --><p><b>Expectation-Matching module:</b> </p><div class="fragment"><div class="line">cd ematch_src/</div>
<div class="line">./compile_all.sh</div>
</div><!-- fragment --><p><b>Knapsack module:</b> </p><div class="fragment"><div class="line">cd knapsack_src/</div>
<div class="line">./compile_all.sh</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
2. Verify Python Installation</h2>
<p>Python 3.7+ should already be available on most systems: </p><div class="fragment"><div class="line">python3 --version</div>
</div><!-- fragment --><p>All Python scripts are standalone and require no additional packages.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md14"></a>
Input Format</h1>
<p>The code takes pre-processed data as input. Format:</p>
<div class="fragment"><div class="line">700218  AAA     40  40  40</div>
<div class="line">25078   AAC     40  40  3</div>
<div class="line">25010   AAG     40  40  3</div>
<div class="line">25315   AAT     40  40  3</div>
<div class="line">25045   ACA     40  3   40</div>
</div><!-- fragment --><p><b>Columns:</b></p><ol type="1">
<li><b>Observed count</b> - Actual count of the read</li>
<li><b>Sequence</b> - The DNA read (ACGT format)</li>
<li><b>Quality scores</b> - Average quality score for each base position</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md16"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md17"></a>
Recommended: Python (Optimized)</h2>
<p>The <b>Python version</b> is 2-5x faster and recommended for all new workflows:</p>
<div class="fragment"><div class="line">python3 ngsfeatgen.py &lt;input&gt;</div>
</div><!-- fragment --><p><b>Example:</b> </p><div class="fragment"><div class="line">python3 ngsfeatgen.py small-len10-50.txt</div>
</div><!-- fragment --><p><b>With custom parameters:</b> </p><div class="fragment"><div class="line">python3 ngsfeatgen.py input.txt --capacity 20 --min-base-error 0.001</div>
</div><!-- fragment --><p><b>Get help:</b> </p><div class="fragment"><div class="line">python3 ngsfeatgen.py --help</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md18"></a>
Available Python Scripts</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Script   </th><th class="markdownTableHeadNone">Purpose   </th><th class="markdownTableHeadNone">Speedup vs Perl    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ngsfeatgen.py</code>   </td><td class="markdownTableBodyNone">Full feature generation pipeline   </td><td class="markdownTableBodyNone">1.2-1.5x    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>recount_capacity.py</code>   </td><td class="markdownTableBodyNone">Capacity-based analysis   </td><td class="markdownTableBodyNone">1.2-1.5x    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>src/lr.py</code>   </td><td class="markdownTableBodyNone">Log-likelihood ratio only   </td><td class="markdownTableBodyNone">1.2-1.5x    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>src/scc.py</code>   </td><td class="markdownTableBodyNone">Sequence certainty coefficient   </td><td class="markdownTableBodyNone">2-3x    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>src/convert_first_col2atcg.py</code>   </td><td class="markdownTableBodyNone">Convert numeric DNA to ACGT   </td><td class="markdownTableBodyNone">10-15x   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md19"></a>
Individual Analysis Tools</h2>
<p><b>Sequence Certainty Coefficient:</b> </p><div class="fragment"><div class="line">python3 src/scc.py input.txt</div>
</div><!-- fragment --><p><b>Log-Likelihood Ratio:</b> </p><div class="fragment"><div class="line">python3 src/lr.py input.txt</div>
</div><!-- fragment --><p><b>Capacity-based Recount:</b> </p><div class="fragment"><div class="line">python3 recount_capacity.py input.txt 30</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md21"></a>
Output</h1>
<p>The tool generates a tab-separated file with multiple features:</p>
<div class="fragment"><div class="line"># Tag Observed_Count Predicted_Count LLRatio EntropyPj EntropyEstCount SCC ExpMatch Knapsack</div>
<div class="line">AAA 700218 695234.123 0.234 0.123 0.456 0.991 0.987 0.992</div>
<div class="line">AAC 25078  24123.456  0.145 0.089 0.234 0.945 0.932 0.941</div>
<div class="line">...</div>
</div><!-- fragment --><p><b>Features:</b></p><ul>
<li><b>Tag</b>: DNA sequence</li>
<li><b>Observed_Count</b>: Raw count from sequencer</li>
<li><b>Predicted_Count</b>: Estimated true count (EM algorithm)</li>
<li><b>LLRatio</b>: Log-likelihood ratio</li>
<li><b>EntropyPj</b>: Entropy probability</li>
<li><b>EntropyEstCount</b>: Entropy-based estimate</li>
<li><b>SCC</b>: Sequence Certainty Coefficient (quality-based)</li>
<li><b>ExpMatch</b>: Expectation-Matching estimate</li>
<li><b>Knapsack</b>: Knapsack-based estimate</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md23"></a>
Performance Benchmarks</h1>
<p>Performance improvements on typical NGS datasets:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Component   </th><th class="markdownTableHeadNone">Original   </th><th class="markdownTableHeadNone">Optimized   </th><th class="markdownTableHeadNone">Speedup    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">C++ binaries   </td><td class="markdownTableBodyNone">Baseline   </td><td class="markdownTableBodyNone">C++20 + flags   </td><td class="markdownTableBodyNone">2-3x    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Python scripts   </td><td class="markdownTableBodyNone">Perl baseline   </td><td class="markdownTableBodyNone">Python 3   </td><td class="markdownTableBodyNone">2-5x    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DNA conversion   </td><td class="markdownTableBodyNone">Perl tr///   </td><td class="markdownTableBodyNone">str.translate()   </td><td class="markdownTableBodyNone">10-15x    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Full pipeline   </td><td class="markdownTableBodyNone">Baseline   </td><td class="markdownTableBodyNone">All optimizations   </td><td class="markdownTableBodyNone">4-15x   </td></tr>
</table>
<p><em>Benchmarks measured on modern x86_64 systems with <code>-march=native</code> optimizations.</em></p>
<hr  />
<h1><a class="anchor" id="autotoc_md25"></a>
Advanced Usage</h1>
<h2><a class="anchor" id="autotoc_md26"></a>
Custom Compiler Flags</h2>
<p>The build system uses optimized flags by default: </p><div class="fragment"><div class="line">-O3 -march=native -mtune=native -flto -ffast-math</div>
</div><!-- fragment --><p>To disable native optimizations (for portability): </p><div class="fragment"><div class="line"># Edit src/makefile and remove -march=native -mtune=native</div>
<div class="line">make clean</div>
<div class="line">make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md27"></a>
Memory Optimization</h2>
<p>For large datasets, Python scripts use generators for memory efficiency: </p><div class="fragment"><div class="line"># Process large files without loading entire file into memory</div>
<div class="line">cat large_input.txt | python3 src/convert_first_col2atcg.py &gt; output.txt</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md29"></a>
Documentation</h1>
<ul>
<li><b>Main README</b>: This file</li>
<li><b>Python Port Guide</b>: <a class="el" href="md_PYTHON__PORT__README.html">PYTHON_PORT_README.md</a> - Detailed Python optimization documentation</li>
<li><b>Original Paper</b>: See Publication section below</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md31"></a>
Architecture</h1>
<div class="fragment"><div class="line">NGSFeatures Pipeline</div>
<div class="line">â”œâ”€â”€ Input: Preprocessed reads with quality scores</div>
<div class="line">â”œâ”€â”€ Feature Generation (C++ optimized, 2-3x faster)</div>
<div class="line">â”‚   â”œâ”€â”€ FindNeighboursWithQual - Hamming distance neighbors</div>
<div class="line">â”‚   â”œâ”€â”€ GenerateProportion - Sequence proportions</div>
<div class="line">â”‚   â”œâ”€â”€ EstimateTrueCount - EM algorithm (with early convergence)</div>
<div class="line">â”‚   â”œâ”€â”€ EstimateTrueCount_llratio - Log-likelihood variant</div>
<div class="line">â”‚   â”œâ”€â”€ EstimateTrueCount_EntropyFast - Entropy-based</div>
<div class="line">â”‚   â””â”€â”€ EstimateTrueCount_Capacity - Capacity-based</div>
<div class="line">â”œâ”€â”€ Quality Analysis (Python, 2-5x faster)</div>
<div class="line">â”‚   â”œâ”€â”€ SCC calculation (sequence certainty)</div>
<div class="line">â”‚   â””â”€â”€ Expectation-Matching correction</div>
<div class="line">â””â”€â”€ Output: Feature vectors for SVM classification</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md33"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md34"></a>
Boost Library Not Found</h2>
<div class="fragment"><div class="line"># Ubuntu/Debian</div>
<div class="line">sudo apt-get install libboost-all-dev</div>
<div class="line"> </div>
<div class="line"># macOS</div>
<div class="line">brew install boost</div>
<div class="line"> </div>
<div class="line"># CentOS/RHEL</div>
<div class="line">sudo yum install boost-devel</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md35"></a>
Python Version Too Old</h2>
<div class="fragment"><div class="line"># Check version</div>
<div class="line">python3 --version</div>
<div class="line"> </div>
<div class="line"># Should be 3.7+</div>
<div class="line"># Update if needed (Ubuntu example)</div>
<div class="line">sudo apt-get install python3.9</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md36"></a>
Compilation Errors</h2>
<div class="fragment"><div class="line"># Clean and rebuild</div>
<div class="line">cd src/</div>
<div class="line">make clean</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># If -march=native fails, edit makefile and remove it</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md38"></a>
Publication</h1>
<p>E.Wijaya, J-F Pessiot, M. C. Frith, W. Fujibuchi, K. Asai and P. Horton, <em>In Search of True Reads: A Classification Approach to Next Generation Sequencing Data Selection</em>, in Proc. 2010 IEEE International Conference on Bioinformatics and Biomedicine (BIBM) Next Generation Sequencing Workshop, 561-566. (<a href="http://bit.ly/1ATrBmR">IEEE</a>)</p>
<hr  />
<h1><a class="anchor" id="autotoc_md40"></a>
Contributors</h1>
<ul>
<li><b>Edward Wijaya</b> - Original implementation (2009)</li>
<li><b>Paul Horton</b> - Algorithm design and research</li>
<li><b>2025 Optimizations</b> - C++ and Python performance improvements</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md42"></a>
License</h1>
<p>Copyright 2009-2025, Edward Wijaya and contributors</p>
<hr  />
<h1><a class="anchor" id="autotoc_md44"></a>
Questions, Comments, Problems</h1>
<p><b>Contact:</b> <a href="#" onclick="location.href='mai'+'lto:'+'ewi'+'ja'+'ya@'+'gm'+'ail'+'.c'+'om'; return false;">ewija<span class="obfuscator">.nosp@m.</span>ya@g<span class="obfuscator">.nosp@m.</span>mail.<span class="obfuscator">.nosp@m.</span>com</a> or <a href="#" onclick="location.href='mai'+'lto:'+'p-h'+'or'+'ton'+'@a'+'ist'+'.g'+'o.j'+'p'; return false;">p-hor<span class="obfuscator">.nosp@m.</span>ton@<span class="obfuscator">.nosp@m.</span>aist.<span class="obfuscator">.nosp@m.</span>go.j<span class="obfuscator">.nosp@m.</span>p</a></p>
<p><b>Issues:</b> <a href="https://github.com/ewijaya/ngsfeatures/issues">https://github.com/ewijaya/ngsfeatures/issues</a></p>
<p>When reporting problems, please include:</p><ul>
<li>Operating system and version</li>
<li>Python version (<code>python3 --version</code>)</li>
<li>C++ compiler version (<code>g++ --version</code>)</li>
<li>Exact command that triggered the error</li>
<li>Complete error message</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md46"></a>
Changelog</h1>
<h2><a class="anchor" id="autotoc_md47"></a>
2025 - Major Performance Update</h2>
<ul>
<li>âœ… Optimized C++ codebase (2-3x faster)</li>
<li>âœ… Ported all Perl scripts to Python 3 (2-5x faster)</li>
<li>âœ… Modern build system with aggressive optimizations</li>
<li>âœ… Comprehensive documentation and benchmarks</li>
<li>âœ… 4-15x overall performance improvement</li>
</ul>
<h2><a class="anchor" id="autotoc_md48"></a>
2009 - Initial Release</h2>
<ul>
<li>Original C++ implementation</li>
<li>Perl wrapper scripts</li>
<li>Publication in IEEE BIBM 2010 </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Nov 20 2025 07:05:45 for NGSFeatures by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
